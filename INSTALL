# 1. Create the data storage path

The default location to store data is /data, about 4GB of data will be downloaded/stored.

Create this directory by running:

mkdir /data


# 2. Download this code

The downloader needs to be in a subdirectory of the data storage path.

cd /data

git clone git@github.com:SPLASHDT/downloader.git


# 3. Edit the data storage path in the code (if required)

Change the BASE_DIR line in download_SPLASH_data.sh to your data storage path.

Edit the downloader_crontab file and change "/data/downloader" to the path of the downloader code.

# 4. Install the crontab

Inside the downloader directory run:

crontab downloader_crontab

The cron job will run at every hour divisble by 5 (e.g. midnight, 5am, 10am, 5pm, 10pm). This ensures we capture data at a sensible time when it gets generated by the metoffice.

# 5. Setup the credentails file

There are no credentials stored in the Github repository. Create a file called credentials.sh in the downloader's directory (e.g. /data/downloader). Add the following lines and set 
it to your real username and password.

user="yourusername"
password="yourpassword"

# 6. Checking everything has worked

Logs are stored in /data/downloader/cron.log

The wave data directory (/data/data_inputs/wave/) should contain 6 NetCDF files with name the naming convention:

metoffice_wave_amm15_NWS_WAV_bYYYYMMDD_hiYYYMMDD.nc

Where the first YYYYMMDD is always todays date (e.g. 20250312) and the second is either today or one of the next 5 day's.

The wind data directory (/data/data_inputs/wind) should contain 4 Grib2 files with the naming convention:

agl_wind-direction-YYYYMMDD.grib2
agl_wind-speed-YYYYMMDD.grib2

There should be one with today's date and one with yesterday's date.


# 7. Downloading the static data

In addition to the daily data the digital twin relies on some models, tidal predictions (valid until December 2026) and two example datasets from notable storms.
These are supplied in a zip file which should be extracted into /data (or it's equivalent). This will create the following subdirectories:

data_inputs/dawlish_models
data_inputs/penzance_models
data_inputs/water
data_inputs/wave/no_overtopping
data_inputs/wave/storm_bert
data_inputs/wind/no_overtopping
data_inputs/wind/storm_bert

# 8. Install the Docker containers

git clone --recuse-submodules git@github.com:SPLASHDT/splash-docker.git

cd splash-docker

(edit docker-compose.yaml and change "source: /data" to the location of the data directory)

docker-compose build
docker-compose start

This should have the SPLASH server running on port 8050. Change the first 8050 under the frontend service if you want it to use a different port.
This can then be proxied via Apache/Nginx for web access.

## Stop the docker containers

In the splash-docker directory run:

docker-compose stop

